<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui" xmlns:c="http://java.sun.com/jsp/jstl/core" template="/WEB-INF/template.xhtml">
	<ui:define name="content">

		<p:growl showDetail="false" sticky="false">
			<p:autoUpdate />
		</p:growl>
		<h:panelGroup id="discgrantGroup">

			<div class="ui-g">
				<div class="ui-g-12">
					<ui:include src="/pages/includes/taskdiagram.xhtml" />
					<br />
					<ui:include src="/pages/includes/tabinfo.xhtml">
						<ui:param name="showInfoCircle" value="true" />
						<ui:param name="cssClass" value="secondaryText Fs15" />
						<ui:param name="helpTxt" value="#{lang['The.system.will.auto-fill.based.selections']}" />
					</ui:include>
				</div>
			</div>
			<h:form id="siteSmeApprovalForm">
				<p:importEnum type="haj.com.entity.enums.CompanyStatusEnum" />
				<p:importEnum type="haj.com.entity.enums.ApprovalEnum" />
				<p:importEnum type="haj.com.entity.enums.UserPermissionEnum" />
				<div class="card">
					<h2>#{siteSmeApprovalUI.company.companyName} Mentor Approval</h2>
					<p:tabView id="tabView">
						<p:tab title="Company Details">
							<p:panelGrid columns="3" style="width:100%" id="companyInsGrid" layout="grid" styleClass="ui-panelgrid-blank">
								<h:panelGroup>
									<p:outputLabel value="#{lang['companyName']}" for="companyName" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="companyName" value="#{siteSmeApprovalUI.company.companyName}" style="width:95%" required="true" requiredMessage="#{lang['enter.the.company.name']}" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['tradingName']}" for="tradingName" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="tradingName" value="#{siteSmeApprovalUI.company.tradingName}" style="width:95%" required="true" requiredMessage="#{lang['enter.the.trading.name']}" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['telNumber']}" for="telNumberComp" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="telNumberComp" value="#{siteSmeApprovalUI.company.telNumber}" style="width:95%" required="true" requiredMessage="#{lang['enter.the.tel.number']}" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['faxNumber']}" for="faxNumberComp" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="faxNumberComp" value="#{siteSmeApprovalUI.company.faxNumber}" style="width:95%" rendered="#{siteSmeApprovalUI.company.faxNumber ne null and siteSmeApprovalUI.company.faxNumber.length() gt 0}" />
									<p:outputLabel id="faxNumberComp2" value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.faxNumber eq null or siteSmeApprovalUI.company.faxNumber.length() eq 0}" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['companyRegistrationNumber']}" for="companyRegistrationNumber" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="companyRegistrationNumber" value="#{siteSmeApprovalUI.company.companyRegistrationNumber}" style="width:95%" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['email']}" for="emailComp" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="emailComp" value="#{siteSmeApprovalUI.company.email}" style="width:95%" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['levyNumber']}" for="levyNumber" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="levyNumber" value="#{siteSmeApprovalUI.company.levyNumber}" style="width:95%" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['numberOfEmployees']}" for="numberOfEmployees" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="numberOfEmployees" value="#{siteSmeApprovalUI.company.numberOfEmployees}" style="width:95%" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['sicCode']}" for="sicCode" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel id="sicCode" value="#{siteSmeApprovalUI.company.sicCode.description}" style="width:95%" required="true" requiredMessage="#{lang['enter.sic.code']}" />
								</h:panelGroup>
								<h:panelGroup>
									<p:outputLabel value="#{lang['organisation.type']}" for="organisationType" styleClass="Fs12 FontLight" />
									<br />
									<p:outputLabel value="#{lang['n.a']}" rendered="#{siteSmeApprovalUI.company.organisationType eq null}" />
									<p:outputLabel id="organisationType" value="#{siteSmeApprovalUI.company.organisationType.description}" style="width:95%" rendered="#{siteSmeApprovalUI.company.organisationType ne null}" />
								</h:panelGroup>
							</p:panelGrid>
							<p:panelGrid columns="2" style="width:100%" id="companyInsGrida" layout="grid" styleClass="ui-panelgrid-blank">
								<p:fieldset legend="#{lang['residentialAddress']}">
									<p:panelGrid columns="2" style="width : 95%" styleClass="ui-panelgrid-blank" id="addrPcode">
										<h:panelGroup>
											<p:outputLabel value="#{lang['address.line.1']}" for="addr1" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="addr1" value="#{siteSmeApprovalUI.company.residentialAddress.addressLine1}" style="width:95%" required="true" requiredMessage="#{lang['enter.residential.address']}" />
											<br />
											<p:outputLabel value="#{lang['address.line.2']}" for="addr2" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine2 eq null or siteSmeApprovalUI.company.residentialAddress.addressLine2.length() eq 0}" />
											<p:outputLabel id="addr2" style="width:95%" value="#{siteSmeApprovalUI.company.residentialAddress.addressLine2}" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine2 ne null and siteSmeApprovalUI.company.residentialAddress.addressLine2.length() gt 0}" />
										</h:panelGroup>
										<h:panelGroup>
											<p:outputLabel value="#{lang['address.line.3']}" for="addr3" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="addr3" style="width:95%" value="#{siteSmeApprovalUI.company.residentialAddress.addressLine3}" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine3 ne null and siteSmeApprovalUI.company.residentialAddress.addressLine3.length() gt 0}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine3 eq null or siteSmeApprovalUI.company.residentialAddress.addressLine3.length() eq 0}" />
											<br />
											<p:outputLabel value="#{lang['address.line.4']}" for="addr4" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="addr4" style="width:95%" value="#{siteSmeApprovalUI.company.residentialAddress.addressLine4}" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine4 ne null and siteSmeApprovalUI.company.residentialAddress.addressLine4.length() gt 0}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.residentialAddress.addressLine4 eq null or siteSmeApprovalUI.company.residentialAddress.addressLine4.length() eq 0}" />
										</h:panelGroup>
										<h:panelGroup>
											<p:outputLabel value="#{lang['post.code']}" for="pcode" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="pcode" style="width:95%" value="#{siteSmeApprovalUI.company.residentialAddress.postcode}" rendered="#{siteSmeApprovalUI.company.residentialAddress.postcode ne null and siteSmeApprovalUI.company.residentialAddress.postcode.length() gt 0}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.residentialAddress.postcode eq null or siteSmeApprovalUI.company.residentialAddress.postcode.length() eq 0}" />
											<br />
											<h:outputLabel value="#{lang['municipality']}" for="MunicipalityID" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="MunicipalityID" style="width:95%" value="#{siteSmeApprovalUI.company.residentialAddress.municipality.municipalityDesc}" />
										</h:panelGroup>

										<h:panelGroup>
											<div class="EmptyBox40"></div>
										</h:panelGroup>
									</p:panelGrid>
								</p:fieldset>

								<p:fieldset legend="#{lang['postalAddress']}">
									<p:panelGrid columns="2" style="width : 95%" styleClass="ui-panelgrid-blank" id="postalAddress">
										<h:panelGroup>
											<p:outputLabel value="#{lang['address.line.1']}" for="postalAddressaddr1" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressaddr1" value="#{siteSmeApprovalUI.company.postalAddress.addressLine1}" style="width:95%" required="true" requiredMessage="#{lang['enter.postal.address']}" />
											<br />
											<p:outputLabel value="#{lang['address.line.2']}" for="postalAddressaddr2" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressaddr2" style="width:95%" value="#{siteSmeApprovalUI.company.postalAddress.addressLine2}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.postalAddress.addressLine2 eq null or siteSmeApprovalUI.company.postalAddress.addressLine2.length() eq 0}" />
										</h:panelGroup>
										<h:panelGroup>
											<p:outputLabel value="#{lang['address.line.3']}" for="postalAddressaddr3" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressaddr3" style="width:95%" value="#{siteSmeApprovalUI.company.postalAddress.addressLine3}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.postalAddress.addressLine3 eq null or siteSmeApprovalUI.company.postalAddress.addressLine3.length() eq 0}" />
											<br />
											<p:outputLabel value="#{lang['address.line.4']}" for="postalAddressaddr4" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressaddr4" style="width:95%" value="#{siteSmeApprovalUI.company.postalAddress.addressLine4}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.postalAddress.addressLine4 eq null or siteSmeApprovalUI.company.postalAddress.addressLine4.length() eq 0}" />
										</h:panelGroup>
										<h:panelGroup>
											<p:outputLabel value="#{lang['post.code']}" for="postalAddressPcode" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressPcode" style="width:95%" value="#{siteSmeApprovalUI.company.postalAddress.postcode}" required="true" requiredMessage="#{lang['provide.postcode']}" />
											<p:outputLabel value="#{lang['n.a']}" style="width:95%" rendered="#{siteSmeApprovalUI.company.postalAddress.postcode eq null or siteSmeApprovalUI.company.postalAddress.postcode.length() eq 0}" />
											<br />
											<h:outputLabel value="#{lang['municipality']}" for="postalAddressMunicipalityID" styleClass="Fs12 FontLight" />
											<br />
											<p:outputLabel id="postalAddressMunicipalityID" style="width:95%" value="#{siteSmeApprovalUI.company.postalAddress.municipality.municipalityDesc}" />
										</h:panelGroup>

										<h:panelGroup>
											<div>
												<p:outputLabel value="#{lang['same.as.my.address']}" styleClass="Fs12 FontLight" />
											</div>
											<div>
												<p:selectBooleanCheckbox value="#{siteSmeApprovalUI.company.postalAddress.sameAddress}" disabled="true">
												</p:selectBooleanCheckbox>
											</div>
										</h:panelGroup>
									</p:panelGrid>
								</p:fieldset>
							</p:panelGrid>
						</p:tab>
					</p:tabView>
				</div>
				
				<!-- Action Buttons -->
							<c:if test="#{sessionUI.task.processRole eq null}">
								<!-- With SDF/Client -->
								<p:panelGrid columns="1" styleClass="ui-panelgrid-blank" style="width:100%" layout="grid">
									<p:commandButton value="#{lang['complete.task']}" icon="ui-icon-save" update="@form" action="#{siteSmeApprovalUI.clientSubmission}" process="@form" styleClass="flat green-btn Fs18" style="height: 50px;" />
								</p:panelGrid>
							</c:if>
							<c:if
								test="#{sessionUI.task.processRole.rolePermission eq UserPermissionEnum.Edit or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.View or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.Upload or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.EditUpload}">
								<!-- Complete Task -->
								<p:panelGrid columns="2" styleClass="ui-panelgrid-blank" style="width:100%" layout="grid">
									<p:commandButton value="#{lang['complete.task']}" action="#{siteSmeApprovalUI.completeWorkflow}" icon="ui-icon-save" update="@form" process="@form" styleClass="flat green-btn Fs18" style="height: 50px;" />
									<p:commandButton value="#{lang['reject.task']}" oncomplete="PF('rejectReasonsDlg').show()" icon="ui-icon-save" update="@form rejectReasonForm" process="@form" styleClass="flat red-btn Fs18" style="height: 50px;" />
								</p:panelGrid>
							</c:if>
							<c:if test="#{sessionUI.task.processRole.rolePermission eq UserPermissionEnum.Approve}">
								<!-- Approve Permission -->
								<p:panelGrid columns="2" styleClass="ui-panelgrid-blank" style="width:100%" layout="grid">
									<p:commandButton value="#{lang['approve']}" action="#{siteSmeApprovalUI.approveWorkflow}" icon="ui-icon-save" update="@form" process="@form" styleClass="flat green-btn Fs18" style="height: 50px;" />
									<p:commandButton value="#{lang['reject.task']}" oncomplete="PF('rejectReasonsDlg').show()" icon="ui-icon-save" update="@form rejectReasonForm" process="@form" styleClass="flat Fs18" style="height: 50px;" />
								</p:panelGrid>
							</c:if>
							<c:if
								test="#{sessionUI.task.processRole.rolePermission eq UserPermissionEnum.FinalApproval or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.FinalUploadApproval or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.FinalUpload or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.FinalEdit or sessionUI.task.processRole.rolePermission eq UserPermissionEnum.FinalView}">
								<!-- Final Approve Permissions -->
								<p:panelGrid columns="2" styleClass="ui-panelgrid-blank" style="width:100%" layout="grid">
									<p:commandButton id="finalApproveBtn" value="#{lang['final.approval']}" action="#{siteSmeApprovalUI.finalApproveWorkflow}" icon="fa fa-check" onstart="uploadStart()" process="@form" update="@form" styleClass="Fs18 flat green-btn" style="height: 50px" />
									<p:commandButton id="finalRejectBtn" value="#{lang['final.reject']}" icon="fa fa-times" process="@form" oncomplete="PF('finalRejectReasonsDlg').show()" update="@form finalRejectReasonForm" styleClass="Fs18 flat red-btn" style="height: 50px" />
								</p:panelGrid>
							</c:if>
			</h:form>

			<ui:include src="/pages/upload/commonuploadDialogs.xhtml" />

			<p:dialog header="#{lang['upload.documents']}" widgetVar="dlgUploadUser" resizable="false" hideEffect="clip" showEffect="clip" id="commonUPLOADUser" width="80%" responsive="true" modal="true">
				<h:form id="uploadFormUser">
					<h:panelGroup id="uploadGroupUser">
						<div class="ui-g">
							<div class="ui-g-12">
								<div class="card">
									<h1 style="font-weight: bold; font-size: 25px;">#{siteSmeApprovalUI.doc.configDoc eq null ? 'Certified Copy of Trade Test/Qualification' : siteSmeApprovalUI.doc.configDoc.name}</h1>
									<p:panel>
										<h:panelGrid columns="2" style="width: 100%">
											<p:outputLabel value="#{lang['notes']}:" for="note" />
											<p:inputTextarea id="note" value="#{siteSmeApprovalUI.doc.note}" autoResize="false" rows="2" style="width: 90%">
												<p:ajax />
											</p:inputTextarea>
										</h:panelGrid>
										<div class="TexAlCenter">
											<span class="Fleft Fs12 softgray">#{lang['drag.and.drop.your.file.on.the.upload.image.below']}</span> <br />
										</div>
										<p:fileUpload onstart="uploadStart()" oncomplete="uploadDone()" fileUploadListener="#{siteSmeApprovalUI.storeNewFile}" mode="advanced" dragDropSupport="true" showButtons="false" label="#{lang['select.file']}" fileLimitMessage="#{lang['file.to.big.to.upload']}"
											update="uploadFormUser :siteSmeApprovalForm:tabView:smeDocsPanel :siteSmeApprovalForm:tabView:qualificationsPanel" multiple="false" fileLimit="1" immediate="false" auto="true" />
									</p:panel>
									<div class="EmptyBox10" />
								</div>
							</div>
						</div>
					</h:panelGroup>
				</h:form>
			</p:dialog>

			<p:dialog header="Reject Reasons" widgetVar="rejectReasonsDlg" hideEffect="clip" showEffect="clip" id="dialogRejectReason" appendTo="@(body)" modal="true" closable="true" width="50%" height="60vh" responsive="true">
				<h:form id="rejectReasonForm">
					<div class="ui-fluid">
						<div class="ui-g">
							<div class="ui-g-12">
								<p:selectManyMenu value="#{siteSmeApprovalUI.selectedRejectionReasons}" converter="RejectReasonsConvertor" scrollHeight="400" style="width:95%" required="true" var="t" requiredMessage="Please select a reject reason" showCheckbox="true">
									<f:selectItems value="#{siteSmeApprovalUI.rejectReasons}" var="rv" itemValue="#{rv}" />
									<p:column>
										<h:outputText value="#{t.description}" />
										<br />
										<h:outputText styleClass="Fs12 gray" value="#{t.howTo}" />
									</p:column>
								</p:selectManyMenu>
							</div>
						</div>
						<p:commandButton value="Reject" action="#{siteSmeApprovalUI.rejectWorkflow}" />
					</div>
				</h:form>
			</p:dialog>

			<p:dialog header="Final Reject Reasons" widgetVar="finalRejectReasonsDlg" hideEffect="clip" showEffect="clip" id="dialogFinalRejectReason" appendTo="@(body)" modal="true" closable="true" width="50%" height="60vh" responsive="true">
				<h:form id="finalRejectReasonForm">
					<div class="ui-fluid">
						<div class="ui-g">
							<div class="ui-g-12">
								<p:selectManyMenu value="#{siteSmeApprovalUI.selectedRejectionReasons}" converter="RejectReasonsConvertor" scrollHeight="400" style="width:95%" required="true" var="t" requiredMessage="Please select a reject reason" showCheckbox="true">
									<f:selectItems value="#{siteSmeApprovalUI.rejectReasons}" var="rv" itemValue="#{rv}" />
									<p:column>
										<h:outputText value="#{t.description}" />
										<br />
										<h:outputText styleClass="Fs12 gray" value="#{t.howTo}" />
									</p:column>
								</p:selectManyMenu>
							</div>
						</div>
						<p:commandButton value="Final Reject" action="#{siteSmeApprovalUI.finalRejectWorkflow}" />
					</div>
				</h:form>
			</p:dialog>
		</h:panelGroup>
	</ui:define>
</ui:composition>
