/* 
 SET GLOBAL max_allowed_packet=1073741824;



update users set password = '9L9biPEyaj+S/cU/l/slswFDOGoRu9AbbdhdwYimPuMt3j2Cuy7CKmVVsyhWfxDr' where id > 1;

user merseta;
SET GLOBAL max_allowed_packet=1073741824;
update users set email = (select replace(concat(concat(first_name, '.'), concat(last_name, '@a.com')), ' ', '')) we id > '1'her;
update users set password = '43dNOuLRKwTiw3QtnIgCwF/t1/oZduo0Orb0UJaMQClLIBUlh7neqfV98kuXk61S' where id > 1;  Merseta01! ;
update banking_details set bank_acc_number = (SELECT  FLOOR(RAND() * (99999999999 - 10000000000 )) + 10000000000  as bank_acc_number);
update users set email = 'musa.mtshali2@a.com' where id = 528;
update  doc_byte set data = (X'255044462D312E330A25C4E5F2E5EBA7F3A0D0C4C60A342030206F626A0A3C3C202F4C656E677468203520302052202F46696C746572202F466C6174654465636F6465203E3E0A73747265616D0A78012B5408542854300042534B533D230B050B13433D0B4B85A2548570853C057DE7624385E4620543302C4E06AAD335D03334B0B4B43035016A3103AA3702294EE3C26F8E3BD09CF462057DB75C4305977C85400048E91B340A656E6473747265616D0A656E646F626A0A352030206F626A0A38390A656E646F626A0A322030206F626A0A3C3C202F54797065202F50616765202F506172656E74203320302052202F5265736F7572636573203620302052202F436F6E74656E7473203420302052202F4D65646961426F78205B302030203539352E3238203834312E38395D0A3E3E0A656E646F626A0A362030206F626A0A3C3C202F50726F63536574205B202F504446205D202F436F6C6F725370616365203C3C202F437331203720302052203E3E202F457874475374617465203C3C202F477331203131203020520A3E3E202F584F626A656374203C3C202F466D31203820302052203E3E203E3E0A656E646F626A0A382030206F626A0A3C3C202F4C656E677468203920302052202F46696C746572202F466C6174654465636F6465202F54797065202F584F626A656374202F53756274797065202F466F726D202F466F726D547970650A31202F42426F78205B32332032303520363239203639375D202F5265736F757263657320313020302052202F47726F7570203C3C202F53202F5472616E73706172656E6379202F43530A313220302052202F492074727565202F4B2066616C7365203E3E203E3E0A73747265616D0A7801454FCD6A02410CBEFB14DFB11E8C934C329B5C6BF7AC96401F60514A710B76DF1F9C9582E490F0FD25B9E38C3B76B5D0509A08C499A4B16386D54A222C68D1282A1B6E681EA46E0A75ED5837DCC06264E69B16DD29ABEA1B5FF845010F068B060DC1DFE509EE0F0B635A3AB9D632F5E585BC6858D716B2A8B58A62F71A5F34B3D2A0EB911A3418C7669AF19E707F86FDB79CB1CF6430F28AB7D3E731C7438E1F5BE40FC6ECEF9E1F7B1C340E0A656E6473747265616D0A656E646F626A0A392030206F626A0A3137340A656E646F626A0A31302030206F626A0A3C3C202F50726F63536574205B202F504446202F54657874205D202F436F6C6F725370616365203C3C202F437331203720302052203E3E202F466F6E74203C3C202F545431203133203020520A3E3E203E3E0A656E646F626A0A31312030206F626A0A3C3C202F54797065202F457874475374617465202F636120302E31383738203E3E0A656E646F626A0A31342030206F626A0A3C3C202F4C656E67746820313520302052202F4E2033202F416C7465726E617465202F446576696365524742202F46696C746572202F466C6174654465636F6465203E3E0A73747265616D0A78019D96775453D91687CFBD37BDD012222025F41A7A0920D23B48150451894980500286842676440546141129566454C0014787226345140B838262D709F21050C6C1514445E5DD8C6B09EFAD35F3DE9AFDC759DFD9E7B7D7D967EF7DD7BA0050FC8204C27458018034A15814EEEBC15C1213CBC4F7021810010E5801C0E166660447F84402D4FCBD3D9999A848C6B3F6EE2E8064BBDB2CBF502673D6FF7F912237432406000A45D5363C7E2617E5029453B3C51932FF04CAF495293286313216A109A2AC22E3C4AF6CF6A7E62BBBC9989726E4A11A59CE19BC349E8CBB50DE9A25E1A38C04A15C9825E067A37C0765BD54499A00E5F728D3D3F89C4C003014995FCCE726A16C8932451419EE89F202000894C439BC720E8BF939689E0078A667E48A04894962A611D79869E5E8C866FAF1B353F962312B94C34DE188784CCFF4B40C8E301780AF6F96450125596D996891EDAD1CEDED59D6E668F9BFD9DF1E7E53FD3DC87AFB55F126ECCF9E418C9E59DF6CECAC2FBD1600F6245A9B1DB3BE955500B46D0640E5E1AC4FEF2000F20500B4DE9CF31E866C5E92C4E20C270B8BECEC6C73019F6B2E2BE837FB9F826FCABF8639F799CBEEFB563BA6173F81234915336545E5A6A7A64B44CCCC0C0E97CF64FDF710FFE3C03969CDC9C32C9C9FC017F185E85551E89409848968BB853C8158902E640A847FD5E17F18362707197E9D6B1468755F007D853950B84907C86F3D00432303246E3F7A027DEB5B10310AC8BEBC68AD91AF738F327AFEE7FA1F0B5C8A6EE14C412253E6F60C8F647225A22C19A3DF846CC10212900774A00A34812E30022C600D1C80337003DE2000848048100396032E4802694004B2413ED8000A4131D80176836A7000D4817AD0044E823670065C0457C00D700B0C8047400A86C14B3001DE81690882F01015A241AA9016A40F9942D6101B5A0879434150381403C5438990109240F9D026A8182A83AAA143503DF423741ABA085D83FAA007D0203406FD017D84119802D3610DD800B680D9B03B1C0847C2CBE04478159C0717C0DBE14AB8163E0EB7C217E11BF0002C855FC2930840C80803D14658081BF144429058240111216B9122A402A9459A900EA41BB98D489171E4030687A161981816C619E387598CE1625661D6624A30D5986398564C17E63666103381F982A562D5B1A65827AC3F760936119B8D2DC456608F605BB097B103D861EC3B1C0EC7C019E21C707EB8185C326E35AE04B70FD78CBB80EBC30DE126F178BC2ADE14EF820FC173F0627C21BE0A7F1C7F1EDF8F1FC6BF2790095A046B820F219620246C2454101A08E708FD8411C2345181A84F7422861079C45C6229B18ED841BC491C264E93144986241752242999B48154496A225D263D26BD2193C93A6447721859405E4FAE249F205F250F923F50942826144F4A1C4542D94E394AB94079407943A5520DA86ED458AA98BA9D5A4FBD447D4A7D2F47933397F397E3C9AD93AB916B95EB977B254F94D79777975F2E9F275F217F4AFEA6FCB80251C140C15381A3B056A146E1B4C23D8549459AA2956288629A62896283E235C55125BC928192B7124FA940E9B0D225A5211A42D3A579D2B8B44DB43ADA65DA301D4737A4FBD393E9C5F41FE8BDF4096525655BE528E51CE51AE5B3CA5206C23060F8335219A58C938CBB8C8FF334E6B9CFE3CFDB36AF695EFFBC2995F92A6E2A7C952295669501958FAA4C556FD514D59DAA6DAA4FD4306A266A616AD96AFBD52EAB8DCFA7CF779ECF9D5F34FFE4FC87EAB0BA897AB8FA6AF5C3EA3DEA931A9A1ABE1A191A551A9734C635199A6E9AC99AE59AE734C7B4685A0BB5045AE55AE7B55E309599EECC546625B38B39A1ADAEEDA72DD13EA4DDAB3DAD63A8B35867A34EB3CE135D922E5B3741B75CB75377424F4B2F582F5FAF51EFA13E519FAD9FA4BF47BF5B7FCAC0D020DA608B419BC1A8A18AA1BF619E61A3E16323AA91ABD12AA35AA33BC63863B6718AF13EE35B26B0899D4992498DC94D53D8D4DE5460BACFB4CF0C6BE6682634AB35BBC7A2B0DC5959AC46D6A039C33CC87CA3799BF92B0B3D8B588B9D16DD165F2CED2C532DEB2C1F59295905586DB4EAB0FAC3DAC49A6B5D637DC7866AE363B3CEA6DDE6B5ADA92DDF76BFED7D3B9A5DB0DD16BB4EBBCFF60EF622FB26FB31073D877887BD0EF7D8747628BB847DD511EBE8E1B8CEF18CE307277B27B1D349A7DF9D59CE29CE0DCEA30B0C17F017D42D1872D171E1B81C72912E642E8C5F7870A1D455DB95E35AEBFACC4DD78DE776C46DC4DDD83DD9FDB8FB2B0F4B0F91478BC794A793E71ACF0B5E8897AF579157AFB792F762EF6AEFA73E3A3E893E8D3E13BE76BEAB7D2FF861FD02FD76FADDF3D7F0E7FAD7FB4F043804AC09E80AA404460456073E0B320912057504C3C101C1BB821F2FD25F245CD4160242FC4376853C09350C5D15FA73182E2C34AC26EC79B855787E7877042D62454443C4BB488FC8D2C8478B8D164B167746C947C545D5474D457B4597454B97582C59B3E4468C5A8C20A63D161F1B157B247672A9F7D2DD4B87E3ECE20AE3EE2E335C96B3ECDA72B5E5A9CBCFAE905FC159712A1E1B1F1DDF10FF8913C2A9E54CAEF45FB977E504D793BB87FB92E7C62BE78DF15DF865FC91049784B284D14497C45D896349AE491549E3024F41B5E075B25FF281E4A9949094A32933A9D1A9CD6984B4F8B4D34225618AB02B5D333D27BD2FC334A33043BACA69D5EE5513A240D1914C28735966BB988EFE4CF5488C249B2583590BB36AB2DE6747659FCA51CC11E6F4E49AE46ECB1DC9F3C9FB7E356635777567BE76FE86FCC135EE6B0EAD85D6AE5CDBB94E775DC1BAE1F5BEEB8F6D206D48D9F0CB46CB8D651BDF6E8ADED451A051B0BE6068B3EFE6C642B94251E1BD2DCE5B0E6CC56C156CEDDD66B3AD6ADB97225ED1F562CBE28AE24F25DC92EBDF597D57F9DDCCF684EDBDA5F6A5FB77E0760877DCDDE9BAF3589962595ED9D0AEE05DADE5CCF2A2F2B7BB57ECBE56615B71600F698F648FB432A8B2BD4AAF6A47D5A7EAA4EA811A8F9AE6BDEA7BB7ED9DDAC7DBD7BFDF6D7FD3018D03C5073E1E141CBC7FC8F7506BAD416DC561DCE1ACC3CFEBA2EABABF677F5F7F44ED48F191CF478547A5C7C28F75D53BD4D737A8379436C28D92C6B1E371C76FFDE0F5437B13ABE95033A3B9F804382139F1E2C7F81FEF9E0C3CD9798A7DAAE927FD9FF6B6D05A8A5AA1D6DCD689B6A436697B4C7BDFE980D39D1DCE1D2D3F9BFF7CF48CF6999AB3CA674BCF91CE159C9B399F777EF242C685F18B8917873A57743EBAB4E4D29DAEB0AEDECB8197AF5EF1B972A9DBBDFBFC5597AB67AE395D3B7D9D7DBDED86FD8DD61EBB9E965FEC7E69E9B5EF6DBDE970B3FD96E3AD8EBE057DE7FA5DFB2FDEF6BA7DE58EFF9D1B038B06FAEE2EBE7BFF5EDC3DE97DDEFDD107A90F5E3FCC7A38FD68FD63ECE3A2270A4F2A9EAA3FADFDD5F8D766A9BDF4ECA0D760CFB388678F86B8432FFF95F9AF4FC305CFA9CF2B46B446EA47AD47CF8CF98CDD7AB1F4C5F0CB8C97D3E385BF29FEB6F795D1AB9F7E77FBBD6762C9C4F06BD1EB993F4ADEA8BE39FAD6F66DE764E8E4D37769EFA6A78ADEABBE3FF681FDA1FB63F4C791E9EC4FF84F959F8D3F777C09FCF278266D66E6DFF784F3FB0A656E6473747265616D0A656E646F626A0A31352030206F626A0A323631320A656E646F626A0A372030206F626A0A5B202F494343426173656420313420302052205D0A656E646F626A0A31362030206F626A0A3C3C202F4C656E67746820313720302052202F4E2033202F416C7465726E617465202F446576696365524742202F46696C746572202F466C6174654465636F6465203E3E0A73747265616D0A780185555B881B5518FE9339C90ABBCED3DAD52DA443BD7429BB4BB615DDA5B49A5B93B46B1AB2D9D51641B3939364CCEC24CE4CD20B7D2A82E28BABBE4941BCBD2D0882D27AC1D607FB52A9505677EB22283EB4784128F445B7F13B936426596A9B65CF7CF3FDDFF96FE79F19A281B542BDAEFB15A225C33673C9A8F2DCD163CAC03AF9E9211AA4511A2CA8563D92CDCE127E422BAEFDBF5B3F904F305727EE6CEF576FB91B2C724B25F2DD07BE56B4D425E0134481B36ADDB4890686C14F1FB7EB028B1C864D2408FCA2C0E536868D8617DBF8354793CFC5A0390B2CAB9542117805787CB1872FF7E0760E50C04F921BDCD45445F4226BD64A9ACE1D437BB987B9477937B8A43750B3F3DB8175C8AACE1DC6750CB5BF522CC4059E045E510B8939E04780AF35B5854C07DFAEDBD11CF06344FE9D8DEA7C04783770AA641E9C07861FBF5969A4BAF89D5395FCB3E0B781FFC658CC1CE9EC5D53AD187A493BC1DFAEF0B4E86F884852343B9D07861FE98059CB093D72904A451E4F008F03BF5EAD1D1639C0A7F499D59C13BCC867ED542526F214FCE5970A87B2C0A3C0BF723D29F48825FD5BB7B39D1C58C8D033222E62B138B79C7AE18785EC4A3E051E71996E9BF9CE5EB65CD20EA63BFA4F2A664AF062EFB5BAEECC28720BF8CD464ED48E5881C982994802C36720CB8D79D14F819BB4E02B10A71A2D6255C9A04D522847498AE25A2713961269A483E1B072301C775DCD84B3CFA22A788D9A8ECDC29A7594ED9D5DAD4265B0065D77B42AC5421F51039E2AF407D88AEB53A118EE1AE0CAFFE3A79DCB8D8E9F1A1B6161B617FFFBD82CDBCFA6D90C29EC29F6343BC0E26067D83ED777167BBA15897C6E204ADBCFCB88C81DDD026ABF881A6D2A60FD058A1A59AE87BEAE2C8F36C63CCB19F3054DBDF2C6DF3DBDD2B0B3EA2A26FA3A7AE45E3D0FFC16B81E58C5BA1ED8707D28819F021BF85B476FBC5A6A9EBDD36571521A4EB4D6A7DB7A165D550495EACECE25744143CDBCA7E6895E1F974E7FF9A0176D959D7BFEEAD0A5D3256379D4634517F8AB995B193A33EEB1E11FC37F8657C3EF853F0CFF2EBD2D7D2A7D259D973E972E93225D902E4A5F4BDF4A1F4B5FB8FABBCD907BF62432177325F216D3D5ADB0B7D79858392A6F971F96E3F20EF95179D65529F2883C25A7E45DB06C77CFCD9B6FA5B772F4E528A275FB73E758E259D15C4F3803DFFD9800CD8BD83703F3C858A3E3F069A2DF62DE0C3A096DEF93D7A98885D8144B6F99EE6931F35DDFC144301E8C9012DC1D9C094E050F09DC7D9683BB609BC19AE8CD0DF3E12AFA2AE5363F21BE2714ABD54F9A5AB9622B7BC2E12795083E7D5C491BEAE4B852D075C531598AC92D6E36797192C47753EC23BA9973BE87BE6D573CCE7E8668FF5F78F77DEF71C71A442B16D1C8E31E378677E503EF129D7B426D98CDB63FF2F9BE23B24A7BF738F7BEA128DE5F3FB75A37F11E1B788B68F3CD56EB9FF75BADCD0FE07F83E882FE1FA09F7C550A656E6473747265616D0A656E646F626A0A31372030206F626A0A313037390A656E646F626A0A31322030206F626A0A5B202F494343426173656420313620302052205D0A656E646F626A0A332030206F626A0A3C3C202F54797065202F5061676573202F4D65646961426F78205B302030203539352E3238203834312E38395D202F436F756E742031202F4B696473205B203220302052205D203E3E0A656E646F626A0A31382030206F626A0A3C3C202F54797065202F436174616C6F67202F5061676573203320302052202F56657273696F6E202F312E34203E3E0A656E646F626A0A31332030206F626A0A3C3C202F54797065202F466F6E74202F53756274797065202F5472756554797065202F42617365466F6E74202F554F43444E572B48656C7665746963614E6575652D4C69676874202F466F6E7444657363726970746F720A313920302052202F456E636F64696E67202F4D6163526F6D616E456E636F64696E67202F466972737443686172203637202F4C61737443686172203834202F576964746873205B203730340A363835203539332030203020302030203020302030203020302037343120363330203020363637203020353536205D203E3E0A656E646F626A0A31392030206F626A0A3C3C202F54797065202F466F6E7444657363726970746F72202F466F6E744E616D65202F554F43444E572B48656C7665746963614E6575652D4C69676874202F466C616773203332202F466F6E7442426F780A5B2D343330202D333035203139383720313136335D202F4974616C6963416E676C652030202F417363656E7420393637202F44657363656E74202D323133202F4361704865696768740A373231202F5374656D56203638202F4C656164696E67203239202F5848656967687420353233202F5374656D48203538202F417667576964746820343239202F4D6178576964746820323232350A2F466F6E7446696C653220323020302052203E3E0A656E646F626A0A32302030206F626A0A3C3C202F4C656E67746820323120302052202F4C656E677468312033353430202F46696C746572202F466C6174654465636F6465203E3E0A73747265616D0A7801C5565F4C5BD719FFCEB9BEB6B906639B0B8438987B31FF821D703076C01402890117282140335B5A9AA2C4FCA9C2421865A9BA763C6C99EA55512B4D95A6EE6152D5687DD8EAB652E4F030A2A6EAB4EC61A852A56DE2B5D2D49755D1A635D262EF77EEBD78499B5579A8B40B3F9F7FDF39E7FBFDEE77BE7337D69FCF52256D9144C3E75717D6C8781CBD289E38BFB9A1996DFE7394C9C5B5A555ABFD67225BFFD2C51716CDB6E3C744F217CBD9850B669BFE8D32BE8C0EB3CDC47A2DCBAB1B57CCB64345A95DBC74DE1A77887D7DAB0B57ACFD694F8C7F6F61356BDA57FD1A6578EDD2F737ACB6287BD7D6B3963D4B13B17EFA6D90D1B3A8994666C5493F24076D02DCE80E102AB67EB2C14C1802A5D35BD7CF553FF14FD620FD4DD8DC38792F25CA4FDFFCFB5071B6F827C76DDBCFD0ACB05630E648BF2F85A8D1F95E71B6A4396EFF774B310F8FB3406A886D934CB55417623B28D294A2E3D442F5183E14DAA13A38F55D3A4D3DA45B3DF5B48C9EE30FF41CC0788ABA1F98D5402728FE400FED90F76BD37C748D363075A4BC740DBDF895CD543A6738D4633944DB7410A2F84305F268A32FAD1C48164809A197835CA5E022E10F951D589DA693D44BADC6541FB8C806BB3EEAA003E0E20BC12B8EF5A76990C2585674ED60F6323D8D89116A348DB6C98E995EECC8F677A4108654FC252846496841E4A61325856CBC9A3E00EE00188E513B1D81D17148210CE761585D1A2137B75135BF43D505C4CB64812A66D2EF31762D5360A59F1428D978136F513AF7CC116C19D6B4D195649E3D8B060FA3A353474D0A6B6379A9756C361DCC68392DF7E4859C36A62D2F5CC8DB5A8D1203D95CA65BCBD35C7A05BFF3693D3F9CF197ABD94C2681756C621D4C81792E83159EB35640697475DF87911C9ED4F252DB4CFA743ABF95F4E7879319BFAE6BA3F95B33E9FCADA45FCF6460652F7B0A8FC58B317D76C0677B27C69DE62A7358034B647239B1265ABC4DCFDFCAE5FC3930317A827A8191D501A6C2466A1D2DB0E199B4181A0EEA7ED111D4833AFCC824B1764578722E3D0A4F74E189F2CD92BACA8EC2B612EEB90C49ABBE2549DD8F2369F56349EA297BFA90A45EF8EC1192FACA920EFBF3549634A8E7B7BE2228FD4F85CB920F3F42F22D53F2AD47485EF390E4EA374B5E5B2602AFEBE07EAD2179FDB724F981C791BCE1B1243F58F6F421C9FDF0F9A090FCD0FF51F2C60724472261FFA01E7E8BDAF86F28C59180F967D4CC3751BE09844BE26E33EF0EC2CD69A72EB44F920F7D1C39EEEB8F0D498E6047B883C47308D9F92E6B611FF108FF847F891E8E944FEC435C50126C5C84CCD08D14D21D39DAAA7BF556AFEE65DBC52DB655BCC25E73B22F9C45CC100FA3B6D25DFE2BFE173A4CABDBA461AA846CAA7946FCD84FC315A3511B1007C68033C022B0095C05DE00AE0337808F81AAB323327D8ACA67003F8BE4EF278FB1A4DF239275AB51B77B224759B44B0A36BB79AD1AE0D19E217E2CE846BB8BC77A87D00E703E9B74C44E2D44E77F34DFD9899FE34B531147526E49CCF48C2F8E34358D2C8EB78F0F1C6677FBCE0C040697AE4E4C5C5D1CEC9878EE44646EA8259EB99C1858CBC4EBC323421BDCC5FCA7C8E94E5CA22F15A8BE7B9B1490174C150FDA80BC8783BB07E7FF0A7F3F07F8594850814A037018E8079E0432C00AF002F00AF00BE01DE026F007A04AB0AE80B262F90AB0266C26EA04D635DEE8108BF5B6B54B5E41B25675F360EA5F6FBDFDF65B1FBCFED4A5547373EAD253FCCEFDB8EDDDF7DF7FD7767F8D9FD153EB3333EB295DBC2BC123011E2E8A8A2D4C0615F0DEB68B3DC5F7881412FBE18632F6DB0663D9A83B8DBDF51882C1408ADD2DCEB26BC575F68ED82EC10E26184F08AD9A110FB7110F35B81FFF58A00E84D161A003BBA8BB00EAB4674407213A08D181EF34600C380388EFB94DE02AF006701DB8017C0C58D141880E6C75162B63D50094574CE51528AFEC2BAF407905CA2B505E81F20A9457A0BC02E51528AF407905CA2B505E81F28AA97C35A609F6D5503E68B10F0AF6565C199223CEDAADB88BF5767111878B22A2C6B322B2B2E322C29222EAE65F16D1F7F2BC884296152115CFAC0D242E8BF2724284DCE0A208BDA54184A02065BCA38C116BF5F44A811A106BCC7A210C6C1B001F18CB2663198CE57DC6325C97C1580663198C653096C1580663198C653096C1580663198C6530C657075674EDE2C42BD8EAE1B8ABB4E2C088BB9EBA5AD51E64DE28226F08C70CB45FFD7C3C9D1E2F7E92BC1799EE0B04FAA623EC226B494D4CA4D833F7E3ACC71F9B8A44A662FE7D5E2F829782AFA69B8293992918646EC2E79490BCC9639C1F159CD47D4E2A38A9E0A482930A4E2A38A9E0A482930A4E2A38A9E0A482930A4EAAC149052779D74C62825F15EAA2AF636F1B29C4451D5E5FBFD8AF40DD7B605E89A01442BB8C1300398C53E7B6D88B296E224C29EB80532784D0E3015E1F90EA918ADAF11F134753C8529C9E6AE8EC6B2AFE2EC978E4586305675C72D8275D5576D4AA1ABB82A363C1815361F603D63075428FB6D4B039C835C85B0626DB5C81A646A5AA3BD6EBD38E75FA65EEBE908C8C1FA9436C3091F7F95168E8A076F1618F640FD5640F1848F05E9C70F3DC9A2F55DE8D1C956AF1BABCD198EDCBE43D7E278184F01A4EA9781FC653FAA5C8FB8F789CE86BC309EEC07814DFB7C70C1B66DC31A26A17DFD44F9F3A999CFE4E2895BDB899DD5839BF309D7D3E7B646A656979E33FE049E08E0A656E6473747265616D0A656E646F626A0A32312030206F626A0A313938320A656E646F626A0A32322030206F626A0A2870726F746563746564290A656E646F626A0A32332030206F626A0A284D6163204F5320582031302E31332E332051756172747A20504446436F6E74657874290A656E646F626A0A32342030206F626A0A285061676573290A656E646F626A0A32352030206F626A0A28443A32303138303231393036333130355A303027303027290A656E646F626A0A312030206F626A0A3C3C202F5469746C6520323220302052202F50726F647563657220323320302052202F43726561746F7220323420302052202F4372656174696F6E4461746520323520302052202F4D6F64446174650A323520302052203E3E0A656E646F626A0A787265660A302032360A303030303030303030302036353533352066200A30303030303037393031203030303030206E200A30303030303030323033203030303030206E200A30303030303035303035203030303030206E200A30303030303030303232203030303030206E200A30303030303030313835203030303030206E200A30303030303030333133203030303030206E200A30303030303033373239203030303030206E200A30303030303030343336203030303030206E200A30303030303030383235203030303030206E200A30303030303030383434203030303030206E200A30303030303030393433203030303030206E200A30303030303034393638203030303030206E200A30303030303035313538203030303030206E200A30303030303030393933203030303030206E200A30303030303033373038203030303030206E200A30303030303033373635203030303030206E200A30303030303034393437203030303030206E200A30303030303035303934203030303030206E200A30303030303035333839203030303030206E200A30303030303035363631203030303030206E200A30303030303037373333203030303030206E200A30303030303037373534203030303030206E200A30303030303037373832203030303030206E200A30303030303037383335203030303030206E200A30303030303037383539203030303030206E200A747261696C65720A3C3C202F53697A65203236202F526F6F7420313820302052202F496E666F203120302052202F4944205B203C38303035363830313131663366316165386333623636666663363132623238363E0A3C38303035363830313131663366316165386333623636666663363132623238363E205D203E3E0A7374617274787265660A383030360A2525454F460A');
 
 
 
SELECT id,email FROM users WHERE email IN (SELECT email FROM users GROUP BY email HAVING COUNT(*) > 1);

 update users set email = 'musa.mtshali2@a.com' where id = 528;

select email, first_name, last_name, ifnull(email_confirm_date,'EMAIL NOT CONFIRMED') as email_confirmed, ifnull(last_login,'NEVER') as last_login
from users 
where id > 1
order by  email_confirm_date desc , last_login desc, last_name asc
  
  
  select o.rejectReasons.description, o.additionalInformation, o.user.email ,cu.company.companyName
from RejectReasonsChild o
left join  CompanyUsers cu
on cu.user.id = o.user.id
left join Tasks t
on o.user.id = t.


select o.sdfType.description, coalesce(o.sdf.active,false), count(*) 
from SDFCompany o
group by o.sdfType.description, coalesce(o.sdf.active,false)



select coalesce(o.user.active,false), count(o)
from CompanyUsers o
where o.user.id not in (select x.sdf.id from SDFCompany x)
group by coalesce(o.user.active,false)

  */

select  sum(a.mandatory_levy) , sum(a.discretionary_levy) , sum(a.admin_levy), sum(a.interest) , sum(a.penalty), sum(a.total)
from sars_levy_detail a , sars_employer_detail b
where a.sars_filel_id = 182
and a.sars_filel_id = b.sars_filel_id
and a.ref_no = b.ref_no



select b.`trading_name` , d.`description`

from sars_employer_detail b , sic_code c, chamber d
where b.sic_code_2 = c.code 
and c.chamber_id = d.id
and b.sars_filel_id = 182


select d.description, sum(a.mandatory_levy) as mandatory_levy , sum(a.discretionary_levy) as discretionary_levy , sum(a.admin_levy) as admin_levy, sum(a.interest) as interest , sum(a.penalty) as penalty , sum(a.total) as total
from sars_levy_detail a , sars_employer_detail b,  sic_code c, chamber d
where a.sars_filel_id = 182
and a.sars_filel_id = b.sars_filel_id
and a.ref_no = b.ref_no
and b.sic_code_2 = c.code 
and c.chamber_id = d.id
group by d.description

/* */
drop TEMPORARY TABLE IF EXISTS temp1;
CREATE TEMPORARY TABLE temp1 ENGINE=MEMORY 
as
select ref_no, avg( (mandatory_levy + discretionary_levy + admin_levy   ) ) as lavg
from sars_levy_detail
where arrival_date_1 >= '2016-10-01'
group by ref_no;

/* L000725020	-562.655 */

select * from temp1;

select a.ref_no, (a.mandatory_levy + a.discretionary_levy + a.admin_levy) , b.lavg
from sars_levy_detail a , temp1 b
where a.arrival_date_1 >= '2017-10-01'
and a.ref_no = b.ref_no
and  a.ref_no = 'L000725020'


select a.ref_no, sum( (a.mandatory_levy + a.discretionary_levy + a.admin_levy) ), tmp.lavg
from sars_levy_detail a , (
    select b.ref_no, avg( (b.mandatory_levy + b.discretionary_levy + b.admin_levy   ) ) as lavg
	from sars_levy_detail b
	where b.arrival_date_1 >= '2016-10-01'
	group by b.ref_no
) as tmp
where a.arrival_date_1 >= '2017-10-01'
and  a.ref_no = tmp.ref_no
group by a.ref_no

and  a.ref_no = 'L000725020'



select a.ref_no, sum(a.total-(a.interest + a.penalty) ) , tmp.lavg 
from sars_levy_detail a , (
    select b.ref_no, avg(b.total - (b.interest + b.penalty) ) as lavg
	from sars_levy_detail b
	where b.arrival_date_1 >= '2016-10-01'
	group by b.ref_no
) as tmp
where a.arrival_date_1 >= '2017-10-01'
and  a.ref_no = tmp.ref_no
group by a.ref_no


select a.ref_no, sum(a.total-(a.interest + a.penalty) ) , tmp.lavg , 
case when (sum(a.total-(a.interest + a.penalty))*-1.0) > (tmp.lavg*-1.0) 
     then ((sum(a.total-(a.interest + a.penalty))*-1.0) -(tmp.lavg*-1.0) )
     else  ((tmp.lavg*-1.0)-  (sum(a.total-(a.interest + a.penalty))*-1.0)  ) end as dev_amt,

case when (sum(a.total-(a.interest + a.penalty))*-1.0) > (tmp.lavg*-1.0) 
        then ((((sum(a.total-(a.interest + a.penalty))*-1.0) - (tmp.lavg*-1.0) ) / (tmp.lavg*-1.0)) * 100)
		else ((((tmp.lavg*-1.0) - (sum(a.total-(a.interest + a.penalty))*-1.0)   ) /(sum(a.total-(a.interest + a.penalty))*-1.0) ) * 100) 
		end as devPerc , tmp.cnt
from sars_levy_detail a , (
    select b.ref_no, avg(b.total - (b.interest + b.penalty) ) as lavg ,  count(distinct arrival_date_1) as cnt
	from sars_levy_detail b
	where b.arrival_date_1 >= '2016-09-01' and b.arrival_date_1 < '2017-10-01'
	group by b.ref_no
	having cnt > 11
) as tmp
where a.arrival_date_1 >= '2017-10-01'
and  a.ref_no = tmp.ref_no
group by a.ref_no
order by devPerc desc 




select a.ref_no as sdlnumber, 
      ROUND(sum(a.total-(a.interest + a.penalty) ),2) as latest_levy, 
      ROUND(tmp.lavg,2) as average_levy , 
case when (sum(a.total-(a.interest + a.penalty))*-1.0) > (tmp.lavg*-1.0) 
     then ROUND(  ((sum(a.total-(a.interest + a.penalty))*-1.0) -(tmp.lavg*-1.0) ),2)
     else ROUND( ((tmp.lavg*-1.0)-  (sum(a.total-(a.interest + a.penalty))*-1.0)  ) ,2)
     end as deviation_amount,

case when (sum(a.total-(a.interest + a.penalty))*-1.0) > (tmp.lavg*-1.0) 
        then ROUND(  ((((sum(a.total-(a.interest + a.penalty))*-1.0) - (tmp.lavg*-1.0) ) / (tmp.lavg*-1.0)) * 100),2)
		else ROUND( ((((tmp.lavg*-1.0) - (sum(a.total-(a.interest + a.penalty))*-1.0)   ) /(sum(a.total-(a.interest + a.penalty))*-1.0) ) * 100) ,2)
		end as deviation_percentage , tmp.cnt as no_levies
from sars_levy_detail a , (
    select b.ref_no, avg(b.total - (b.interest + b.penalty) ) as lavg ,  count(distinct arrival_date_1) as cnt
	from sars_levy_detail b
	where b.arrival_date_1 >= DATE_SUB( (select max(arrival_date_1) from sars_levy_detail),INTERVAL 1 YEAR)  and b.arrival_date_1 < (select max(arrival_date_1) from sars_levy_detail)
	group by b.ref_no	
) as tmp
where a.arrival_date_1 >= (select max(arrival_date_1) from sars_levy_detail)
and  a.ref_no = tmp.ref_no
group by a.ref_no
order by deviation_percentage desc 




-- group by chamber --
select f.`description`, (sum(a.mandatory_levy)*-1)
from sars_levy_detail a ,sars_employer_detail b, sic_code c, chamber f
where c.code = b.sic_code_2
and a.sars_filel_id = b.sars_filel_id
and a.ref_no = b.ref_no
and b.sars_filel_id = 182
and c.chamber_id = f.id
group by f.`description`
--


--RECON SQL START--
select sum(mandatory_levy) from sars_levy_detail
where ref_no = 'L910704628'
and scheme_year = 2013
and arrival_date_1 <= '2017-02-01'

select sum(document_amount_d) from t_s2
where scheme_year = 2014
and vendor_id = 'L910704628'



select arrival_date_1, mandatory_levy from sars_levy_detail
where ref_no = 'L910704628'
and scheme_year = 2013
and arrival_date_1 <= '2017-02-01'


select vendor_id,	vendor_name,	voucher_number,	document_type,	account_code, document_date_d,	posted_date_d,	document_amount_d,	scheme_year	
from t_s2
where scheme_year = 2014
and vendor_id = 'L910704628'	
order by document_date_d		


select * from t_s1 
where scheme_year = '2014'
and status_description in ('Paid','Approved')
and levy_number not in (select vendor_id from t_s2 where scheme_year = 2014)


select * from t_s2 
where scheme_year = 2014
and vendor_id not in (select levy_number from t_s1 
					where scheme_year = '2014'
					and status_description in ('Paid'))

select  sum(a.document_amount_d) from t_s2 a
where a.scheme_year = 2016
and a.vendor_id not in (select b.levy_number from t_s1 b
					where b.scheme_year  = 2016
					and b.status_description in ('Paid'))

select distinct(status_description) from t_s1 


--summaray per scheme year



select sum(mandatory_levy) from sars_levy_detail
where ref_no in (select b.levy_number from t_s1 b
					where b.scheme_year  = 2014
					and b.status_description in ('Paid'))
and scheme_year = 2013. //-192678398.4999979


select  sum(a.document_amount_d) from t_s2 a
where a.scheme_year = 2014
and a.vendor_id  in (select b.levy_number from t_s1 b
					where b.scheme_year  = 2014
					and b.status_description in ('Paid')) //192965263.98000124

--RECON SQL END--







select `arrival_date_1` , count(*) from sars_levy_detail 
where scheme_year is null 
group by arrival_date_1


select arrival_date_1 , sum(mandatory_levy) from sars_levy_detail 
where arrival_date_1 
 between '2015-04-01' and '2016-03-30'
group by arrival_date_1


select  sum(mandatory_levy) from sars_levy_detail 
where arrival_date_1 
 between '2015-04-01' and '2016-03-31'
 
 
select  sum(mandatory_levy), sum(discretionary_levy) from sars_levy_detail 
where sars_filel_id = 152

where arrival_date_1 = '2016-08-01' 
group by arrival_date_1
 
 
select  count(distinct ref_no)  from sars_levy_detail 
where scheme_year = 2016

select count(distinct ref_no) from sars_employer_detail
where sars_filel_id in (select  distinct sars_filel_id  from sars_levy_detail 
				where scheme_year = 2016)
and trading_status = 'A'

alter table sars_employer_detail add index hs_l_inx01 (sars_filel_id,trading_status)


select  count(distinct vendor_id )from t_s2 
where scheme_year = 2016

 
where arrival_date_1 
 between '2015-04-01' and '2016-03-31'
 and mandatory_levy <> 0 
 

select sum(document_amount_d) from t_s2
where document_date_d 
between '2015-04-01' and '2016-03-31'


select distinct document_date_d from t_s2
where scheme_year = 2016
order by document_date_d


where document_date_d 
between '2015-04-01' and '2016-03-31'





select distinct count(a.ref_no from sars_employer_detail a, sars_files b
where a.sars_filel_id = b.id
and for_month between '2015-04-01' and '2016-03-31'

select   sum(mandatory_levy) from sars_levy_detail 

where arrival_date_1 <= '2016-03-30'


select  scheme_year , sum(mandatory_levy) from sars_levy_detail 
where scheme_year = 2016
and arrival_date_1 <= '2016-03-30'

select  scheme_year, sum(mandatory_levy) from sars_levy_detail 
where scheme_year = 2016
and arrival_date_1 > '2017-03-30'

select  distinct (arrival_date_1 )from sars_levy_detail 
where scheme_year = 2016
order by arrival_date_1



2016 == 2015/04/1  => 2016/03/31

SARS scheme year 2017 : 2017-03-01 => 2018-02-28      2014 : 2013-04-01 => 2014-03-31
SARS scheme year 2016 : 2016-03-01 => 2017-02-28
SARS scheme year 2015 : 2015-03-01 => 2016-02-28
SARS scheme year 2014 : 2014-03-01 => 2015-02-28


explain select
  count(distinct ref_no) 
 from
  sars_employer_detail 
 
 where
  (
   sars_filel_id in (
    select
     distinct sars_filel_id 
    from
     sars_levy_detail 
    where
     scheme_year=2016
   )
  ) 
   and trading_status = 'A'
   
   select  sars_filel_id, trading_status , count(*) from sars_employer_detail group by sars_filel_id,trading_status





ALTER TABLE sars_employer_detail
PARTITION BY LIST COLUMNS (trading_status)
  (
    PARTITION p01 VALUES IN ('0'),
    PARTITION p02 VALUES IN ('A'),
    PARTITION p03 VALUES IN ('B'),
    PARTITION p04 VALUES IN ('D'),
    PARTITION p05 VALUES IN ('R'),
    PARTITION p06 VALUES IN ('S'),
    PARTITION p07 VALUES IN ('X'),
    PARTITION p08 VALUES IN ('Y')
  );
  
  
 select * , (mandatory_levy+interest+discretionary_levy+penalty+admin_levy ) as tot
from sars_levy_detail
where ( if (penalty < 0, penalty * -1, penalty) >
       if (total < 0, total * -1, total) )
and    arrival_date_1 <= '2013-03-01'    limit 5000

           
                       
                       
select * , ROUND( (mandatory_levy+interest+discretionary_levy+penalty+admin_levy ),2) as tot
from sars_levy_detail
where (total = 0 or total = 1)
and    arrival_date_1 < '2013-03-01' 
 limit 5000
  
  
  
 SELECT TABLE_NAME, COLUMN_NAME, CONSTRAINT_NAME, REFERENCED_TABLE_NAME, REFERENCED_COLUMN_NAME FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE WHERE REFERENCED_TABLE_NAME = 'sars_employer_detail'; 
 ALTER TABLE sars_levy_detail DROP FOREIGN KEY FK739p8awpfxc152nvk579n9b9b;
 
 alter table sars_employer_detail drop index index_hs_1
SHOW INDEX FROM sars_employer_detail


drop table sars_levy_detail;
drop table sars_employer_detail;
drop table sars_files;

CREATE TABLE `sars_files` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `create_date` datetime DEFAULT NULL,
  `for_month` datetime DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=latin1;


CREATE TABLE `sars_employer_detail` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `company_registration_number` varchar(100) DEFAULT NULL,
  `create_date` datetime DEFAULT NULL,
  `ref_no` varchar(50) DEFAULT NULL,
  `registered_name_of_entity` varchar(500) DEFAULT NULL,
  `sic_code_2` varchar(50) DEFAULT NULL,
  `trading_name` varchar(255) DEFAULT NULL,
  `trading_status` varchar(10) DEFAULT NULL,
  `sars_filel_id` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `hs_index_name` (`ref_no`,`sars_filel_id`),
  KEY `hs_l_inx01` (`sars_filel_id`,`trading_status`),
  CONSTRAINT `FK90kbr37mp7qs148a5lvo5syps` FOREIGN KEY (`sars_filel_id`) REFERENCES `sars_files` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=50444 DEFAULT CHARSET=latin1;



CREATE TABLE `sars_levy_detail` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `admin_levy` double DEFAULT NULL,
  `arrival_date_1` datetime DEFAULT NULL,
  `arrival_date_2` datetime DEFAULT NULL,
  `create_date` datetime DEFAULT NULL,
  `mandatory_levy` double DEFAULT NULL,
  `interest` double DEFAULT NULL,
  `discretionary_levy` double DEFAULT NULL,
  `penalty` double DEFAULT NULL,
  `ref_no` varchar(50) DEFAULT NULL,
  `scheme_year` int(11) DEFAULT NULL,
  `seta_code` varchar(50) DEFAULT NULL,
  `total` double DEFAULT NULL,
  `sars_employer_detail_id` bigint(20) DEFAULT NULL,
  `sars_filel_id` bigint(20) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `FK739p8awpfxc152nvk579n9b9b` (`sars_employer_detail_id`),
  KEY `arrival_date_1` (`arrival_date_1`),
  KEY `hs_index_01` (`ref_no`,`arrival_date_1`),
  KEY `index_hs_2` (`sars_filel_id`),
  KEY `scheme_year` (`scheme_year`),
  CONSTRAINT `FK739p8awpfxc152nvk579n9b9b` FOREIGN KEY (`sars_employer_detail_id`) REFERENCES `sars_employer_detail` (`id`),
  CONSTRAINT `FKdxorjdcrkbtjoqty88wmldray` FOREIGN KEY (`sars_filel_id`) REFERENCES `sars_files` (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=15402 DEFAULT CHARSET=latin1;
 